:root {
  /* Core palette */
  --bg: #0b0f14;
  --bg-muted: #0e1520;
  --surface: rgba(17 24 39 / 0.55);
  --surface-elevated: rgba(30 41 59 / 0.6);
  --surface-solid: #182230;
  --border-subtle: rgba(255 255 255 / 0.06);
  --border-strong: rgba(255 255 255 / 0.12);
  --text: hsl(210 40% 96%);
  --text-muted: hsl(215 16% 70%);
  --accent: #3b82f6; /* neon blue default accent */
  --accent-contrast: #ffffff;
  --accent-rgb: 59 130 246;
  --danger: #ef4444;
  --warning: #f59e0b;
  --success: #22c55e;
  --info: #3b82f6;

  /* Radius scale */
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius-md: 14px;
  --radius-lg: 20px;
  --radius-pill: 9999px;

  /* Depth / effects */
  --shadow: 0 10px 30px -8px rgba(0 0 0 / 0.55);
  --shadow-sm: 0 2px 6px -2px rgba(0 0 0 / 0.5);
  --glow: 0 0 0 1px rgba(var(--accent-rgb) / 0.25), 0 0 24px -4px rgba(var(--accent-rgb) / 0.45);
  --ring: hsl(210 90% 60%);
  --ring-alt: hsl(215 100% 72%);
  --focus-outline: 2px solid var(--ring-alt);

  /* Charts */
  --chart-1: #3b82f6;
  --chart-2: #0ea5e9;
  --chart-grid: rgba(255 255 255 / 0.08);

  /* Glass */
  --card: var(--surface);
  --card-border: var(--border-subtle);
  --card-backdrop: blur(14px) saturate(140%);

  /* Background dynamic layer (aurora / gradient) */
  --bg-layer: radial-gradient(at 20% 20%, #1e3a8a 0%, transparent 55%),
    radial-gradient(at 80% 70%, #0ea5e9 0%, transparent 55%),
    radial-gradient(at 40% 80%, #1d4ed8 0%, transparent 55%);
}

/* Light theme overrides */
body[data-theme="light"] {
  --bg: #f5f7fa;
  --bg-muted: #e9eef3;
  --surface: rgba(255 255 255 / 0.75);
  --surface-elevated: rgba(255 255 255 / 0.9);
  --surface-solid: #ffffff;
  --text: #17212c;
  --text-muted: #5b6975;
  --border-subtle: rgba(0 0 0 / 0.08);
  --border-strong: rgba(0 0 0 / 0.16);
  --chart-grid: rgba(0 0 0 / 0.08);
  --card: var(--surface);
}

/* Animated theme swap (disabled when instant flag set) */
body.theme-animate, body.theme-animate * { transition: background-color .45s ease, color .45s ease, box-shadow .45s ease, border-color .45s ease; }
@media (prefers-reduced-motion: reduce) { body.theme-animate, body.theme-animate * { transition: none !important; } }

/* Compact density */
body[data-density="compact"] .bg-card { border-radius: var(--radius-md); }
body[data-density="compact"] .px-3 { padding-left:.6rem; padding-right:.6rem; }
body[data-density="compact"] .py-3 { padding-top:.6rem; padding-bottom:.6rem; }
body[data-density="compact"] .rounded-2xl { border-radius: var(--radius-md); }
body[data-density="compact"] h2, body[data-density="compact"] h3 { font-size: .95rem; }
body[data-density="compact"] .p-4 { padding: .9rem; }
body[data-density="compact"] .gap-4 { gap: .9rem; }
body[data-density="compact"] .space-y-6 > :where(*+*) { margin-top:1.1rem; }
body[data-density="compact"] .text-xl { font-size:1.05rem; }
body[data-density="compact"] .text-sm { font-size:.72rem; }
body[data-density="compact"] .h-64 { height:15rem; }
body[data-density="compact"] .h-56 { height:13rem; }

/* PR marker (small diamond) */
.pr-marker { fill: var(--accent); stroke: #fff; stroke-width: 0.5; transform: rotate(45deg); transform-origin: center; }

/* Section heading underline */
h2.section-heading, h3.section-heading { position:relative; padding-bottom:.4rem; }
h2.section-heading::after, h3.section-heading::after { content:""; position:absolute; left:0; bottom:0; height:2px; width:60px; background:linear-gradient(90deg,var(--accent),transparent); border-radius:2px; }

/* Rest timer completion pulse */
@keyframes restPulse { 0% { box-shadow:0 0 0 0 rgba(var(--accent-rgb)/0.6);} 70% { box-shadow:0 0 0 10px rgba(var(--accent-rgb)/0);} 100% { box-shadow:0 0 0 0 rgba(var(--accent-rgb)/0);} }
.rest-finished { animation: restPulse 1.1s ease-out 1; }
@media (prefers-reduced-motion: reduce) { .rest-finished { animation:none; } }

.bg-app {
  background: var(--bg);
}
.bg-app-muted {
  background: var(--bg-muted);
}
.text-app {
  color: var(--text);
}
.text-muted {
  color: var(--text-muted);
}
.border-card {
  border-color: var(--card-border);
}
.bg-card,
.card-surface {
  background: var(--card);
  box-shadow: var(--shadow);
  border: 1px solid var(--card-border);
  border-radius: var(--radius-lg);
  position: relative;
  overflow: hidden;
}


/* Skeleton */
.skeleton { position: relative; overflow: hidden; background: linear-gradient(90deg,var(--surface-solid) 0%,var(--surface) 40%,var(--surface-solid) 80%); background-size: 200% 100%; animation: shimmer 1.8s linear infinite; border-radius: var(--radius-sm); }
@keyframes shimmer { 0% { background-position: 200% 0 } 100% { background-position: -200% 0 } }

/* Fade / slide entrance */
.fade-in { animation: fadeIn 300ms ease; }
@keyframes fadeIn { from { opacity:0; transform: translateY(4px); } to { opacity:1; transform: translateY(0);} }
/* Reorder slide animation for exercises */
.reorder-anim { animation: reorderPop .28s ease; }
@keyframes reorderPop { 0% { transform:scale(.97) translateY(4px); opacity:.0;} 60% { transform:scale(1.02); opacity:1;} 100% { transform:scale(1); } }
/* Drag handle pulse */
.drag-handle { transition: opacity .2s ease, transform .25s ease; }
.drag-handle:active { transform: scale(.85); }

/* Micro-interactions */
button, .btn-primary, .btn-outline { transition: transform .12s ease, background-color .15s ease, box-shadow .2s ease; }
button:active { transform: scale(.97); }
@media (prefers-reduced-motion: reduce) { button, .fade-in { animation: none !important; transition: none !important; } }

/* Sticky toolbar helper */
.sticky-toolbar { position:sticky; top:3.25rem; /* sit just below main app header */ z-index:40; backdrop-filter: blur(14px) saturate(160%); background: linear-gradient(90deg, rgba(17 24 39 / 0.72), rgba(17 24 39 / 0.55)); border: 1px solid var(--border-subtle); border-left:0; border-right:0; padding-left:1rem; padding-right:1rem; }
@media (min-width:640px){ .sticky-toolbar { margin-left:calc(-1rem + 1px); margin-right:calc(-1rem + 1px); } }

/* Prevent accidental horizontal scroll on narrow mobile view */
html, body, #root { overflow-x:hidden; }
/* Layout variables */
:root { --app-header-h: 56px; }
/* Ensure internal scroll areas don't force width expansion */
.no-scrollbar { scrollbar-width:none; }
.no-scrollbar::-webkit-scrollbar { display:none; }

/* Badges */
.badge { font-size:10px; text-transform:uppercase; letter-spacing:.5px; padding:3px 8px; border-radius: var(--radius-pill); background:rgba(var(--accent-rgb)/0.18); color: var(--accent); display:inline-flex; align-items:center; gap:4px; }
.badge[data-variant="danger"] { background: rgba(239 68 68 / 0.18); color: var(--danger); }
.badge[data-variant="info"] { background: rgba(59 130 246 / 0.18); color: var(--info); }
.badge-outline { background: transparent; border:1px solid var(--border-subtle); }

/* Progress bar */
.progress-track { height:6px; background: linear-gradient(90deg, rgba(255 255 255 / 0.06), rgba(255 255 255 / 0.02)); border-radius: var(--radius-pill); overflow:hidden; }
.progress-fill { height:100%; background: linear-gradient(90deg, var(--accent), #1d4ed8); box-shadow: 0 0 0 1px rgba(255 255 255 / 0.07), 0 2px 6px -2px rgba(var(--accent-rgb)/0.6); }
.ring-app {
  outline: 2px solid var(--ring);
  outline-offset: 2px;
}
.btn-primary {
  background: var(--accent);
  color: var(--accent-contrast);
  box-shadow: var(--glow);
}
.btn-primary:hover {
  filter: brightness(0.98);
}
.btn-outline {
  border: 1px solid var(--card-border);
  background: transparent;
  color: var(--text);
}
.input-app {
  background: var(--bg-muted);
  color: var(--text);
  border: 1px solid var(--card-border);
}
.chart-grid {
  stroke: var(--chart-grid);
}
/* Text helpers */
.text-danger {
  color: var(--danger);
}
.text-success {
  color: var(--success);
}
.text-warning {
  color: var(--warning);
}
/* Focus ring helper */
.focus-ring:focus-visible {
  outline: 2px solid var(--ring);
  outline-offset: 2px;
}
.focus-ring-alt:focus-visible { outline: var(--focus-outline); outline-offset:2px; }

/* Reduced motion override via data attribute */
[data-reduced-motion="true"] * { animation: none !important; transition: none !important; }

/* Colorblind safe shape indicators */
[data-shape="pr"] { position:relative; }
[data-shape="pr"]::after { content:""; position:absolute; inset:2px; border:2px solid rgba(0 0 0 / 0.4); border-radius:4px; pointer-events:none; mix-blend-mode:overlay; }
/* PR pulse animation when a new PR is logged (element gets data-pr="new") */
@keyframes prPulse { 0% { box-shadow:0 0 0 0 rgba(var(--accent-rgb)/0.7); } 70% { box-shadow:0 0 0 10px rgba(var(--accent-rgb)/0); } 100% { box-shadow:0 0 0 0 rgba(var(--accent-rgb)/0); } }
[data-pr="new"] { animation: prPulse 1.4s ease-out 1; }
/* Deload shape: dashed outline */
[data-shape="deload"] { position:relative; }
[data-shape="deload"]::after { content:""; position:absolute; inset:2px; border:2px dashed rgba(251 191 36 / 0.6); border-radius:6px; pointer-events:none; }
/* Hide scrollbars utility (for horizontal chip nav) */
.no-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.no-scrollbar::-webkit-scrollbar {
  display: none;
}

/* Glass toggle via data attribute */
[data-card-style="glass"] .bg-card {
  backdrop-filter: var(--card-backdrop);
}

/* Global aurora/gradient background layer controlled by --bg-layer */
body[data-bg-layer="on"]::before {
  content: "";
  position: fixed;
  inset: -10vmax;
  z-index: -1;
  background: var(--bg-layer);
  filter: blur(0px);
  opacity: 0.9;
  pointer-events: none;
}
@media (prefers-reduced-motion: no-preference) {
  body[data-bg-layer="on"]::before {
    animation: drift 22s ease-in-out infinite alternate;
  }
}
@keyframes drift {
  from {
    transform: translate3d(0, 0, 0) scale(1);
  }
  to {
    transform: translate3d(2%, -2%, 0) scale(1.03);
  }
}

/* Previous week hint pill */
.prev-hint-pill {
  font-size: 0.65rem; /* ~10px */
  line-height: 1rem;
  padding: 2px 6px;
  border-radius: 9999px;
  background: var(--card-border, hsla(0 0% 100% / 0.08));
  color: var(--text-muted, #9ca3af);
  display: inline-flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
  white-space: nowrap;
}
.prev-hint-pill[data-nudge="true"] {
  background: linear-gradient(
    90deg,
    var(--accent, #0ea5e9),
    var(--chart-2, #f472b6)
  );
  color: var(--accent-contrast, #fff);
  box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.08),
    var(--shadow, 0 4px 16px rgba(0, 0, 0, 0.4));
}

/* ECG Background (canvas pulse) */
:root {
  --ecg-color: rgba(var(--accent-rgb,34 197 94) / 0.75);
  --ecg-glow: rgba(var(--accent-rgb,34 197 94) / 0.35);
  --ecg-opacity: 0.2; /* overridden by intensity */
  --ecg-speed: 40s; /* overridden by intensity */
  --ecg-stroke-w: 2;
  --ecg-dash: 4 6;
}
.ecg-root { position:fixed; inset:0; z-index:-1; overflow:hidden; isolation:isolate; }
.ecg-canvas { width:100%; height:100%; display:block; }
body[data-ecg="off"] .ecg-root { display:none; }
