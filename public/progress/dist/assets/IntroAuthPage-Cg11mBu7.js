import{N as e,j as t,J as s,S as a,O as n}from"./index-CS486dXL.js";import{r}from"./vendor-DTtRowIX.js";import"./charts-Cu4NAUVk.js";function i({onSignedIn:s,onForgot:a}){const[n,i]=r.useState("login"),[o,l]=r.useState(""),[c,d]=r.useState(""),[u,x]=r.useState(""),[m,p]=r.useState(!1),[h,g]=r.useState(null),[f,w]=r.useState(null),b=/.+@.+/.test(o),y=c.length>=12?"strong":c.length>=8?"ok":"weak",j=b&&c.length>=6&&!m&&("login"===n||c===u),v=async()=>{g(null),w(null),p(!0);try{if("login"===n){const{error:t}=await async function(t,s){return await e.auth.signInWithPassword({email:t,password:s})}(o,c);t?g(t.message):s()}else{if(c!==u)return void g("Passwords do not match");const t=window.location.origin+window.location.pathname,{data:a,error:n}=await async function(t,s,a){return await e.auth.signUp({email:t,password:s,options:{emailRedirectTo:a}})}(o,c,t);n?g(n.message):a.session?s():w("Check your email to confirm your account")}}finally{p(!1)}};return t.jsxs("div",{className:"glass-card fade-in-pop rounded-2xl p-6 w-full max-w-md mx-auto text-sm relative",children:[t.jsx("div",{className:"flex items-center gap-2 mb-6",role:"tablist","aria-label":"Authentication mode",children:["login","signup"].map(e=>t.jsx("button",{role:"tab","aria-selected":n===e,className:"px-4 py-2 rounded-xl text-xs font-medium transition-colors "+(n===e?"bg-white/10 text-white":"text-gray-400 hover:text-white"),onClick:()=>i(e),disabled:m,children:"login"===e?"Login":"Sign Up"},e))}),t.jsxs("form",{onSubmit:e=>{e.preventDefault(),j&&v()},className:"space-y-4",children:[t.jsxs("label",{className:"block space-y-1",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Email"}),t.jsx("input",{autoComplete:"email",type:"email",required:!0,value:o,onChange:e=>l(e.target.value),className:"input-app w-full rounded-xl px-3 py-3 bg-white/5 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[var(--accent)]"})]}),t.jsxs("label",{className:"block space-y-1",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Password"}),t.jsx("input",{autoComplete:"login"===n?"current-password":"new-password",type:"password",required:!0,value:c,onChange:e=>d(e.target.value),className:"input-app w-full rounded-xl px-3 py-3 bg-white/5 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[var(--accent)]"}),"signup"===n&&t.jsxs("div",{className:"text-[10px] mt-1 flex items-center gap-2",children:[t.jsx("span",{className:"font-medium "+("weak"===y?"text-red-400":"ok"===y?"text-amber-300":"text-emerald-400"),children:y}),t.jsx("span",{className:"text-gray-400",children:"Use at least 12 chars for strong"})]})]}),"signup"===n&&t.jsxs("label",{className:"block space-y-1",children:[t.jsx("span",{className:"text-xs uppercase tracking-wide text-gray-400",children:"Confirm Password"}),t.jsx("input",{type:"password",required:!0,value:u,onChange:e=>x(e.target.value),className:"input-app w-full rounded-xl px-3 py-3 bg-white/5 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[var(--accent)]"})]}),h&&t.jsx("div",{className:"text-xs text-red-400",children:h}),f&&t.jsx("div",{className:"text-xs text-emerald-400",children:f}),t.jsxs("div",{className:"flex items-center justify-between pt-2",children:[t.jsx("button",{type:"submit",disabled:!j,className:"btn-primary rounded-xl px-4 py-3 text-sm font-medium transition-transform disabled:opacity-40 hover:translate-y-[-2px] active:translate-y-[0]",children:m?"...":"login"===n?"Sign In":"Create Account"}),"login"===n&&t.jsx("button",{type:"button",onClick:a,className:"text-xs text-gray-400 hover:text-gray-200 underline decoration-dotted",children:"Forgot password?"})]})]})]})}function o({open:s,onClose:a}){const[n,i]=r.useState(""),[o,l]=r.useState("idle"),[c,d]=r.useState(null);if(!s)return null;return t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",role:"dialog","aria-modal":"true","aria-label":"Password reset",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:a}),t.jsxs("div",{className:"glass-card relative z-10 rounded-2xl p-6 w-full max-w-sm fade-in-pop",children:[t.jsx("h2",{className:"text-base font-semibold mb-2",children:"Reset password"}),t.jsx("p",{className:"text-xs text-gray-400 mb-4",children:"Enter your email. If an account exists, a reset link will be sent."}),t.jsxs("form",{onSubmit:async t=>{t.preventDefault(),l("sending"),d(null);try{const t=window.location.origin+window.location.pathname,{error:s}=await async function(t,s){return await e.auth.resetPasswordForEmail(t,{redirectTo:s})}(n,t);s?(d("Could not send reset"),l("error")):l("sent")}catch{l("error"),d("Error")}},className:"space-y-3",children:[t.jsx("input",{type:"email",required:!0,autoFocus:!0,value:n,onChange:e=>i(e.target.value),placeholder:"you@example.com",className:"w-full rounded-xl px-3 py-3 bg-white/5 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[var(--accent)]"}),c&&t.jsx("div",{className:"text-xs text-red-400",children:c}),"sent"===o&&t.jsx("div",{className:"text-xs text-emerald-400",children:"If that email exists, a reset has been sent."}),t.jsxs("div",{className:"flex items-center justify-end gap-2 pt-1",children:[t.jsx("button",{type:"button",onClick:a,className:"text-xs px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10",children:"Close"}),t.jsx("button",{disabled:"sending"===o||"sent"===o,className:"btn-primary rounded-xl px-4 py-2 text-sm font-medium disabled:opacity-40",children:"sending"===o?"Sendingâ€¦":"sent"===o?"Sent":"Send reset"})]})]})]})]})}const l=["Track lifts & deloads automatically","Visualise progress with charts","Templates for Upper / Lower","Body measurements guidance","Theme presets & sync"];function c(){const e=s(),c=a(),[d,u]=r.useState(!1),x=r.useRef(null);return r.useEffect(()=>{(async()=>{var t;const s=await n({timeoutMs:1200});if(null==s?void 0:s.user){const s=(null==(t=c.state)?void 0:t.redirectTo)||"/";e(s)}})()},[]),r.useEffect(()=>{const e=x.current;if(!e)return;if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;e.dataset.parallax="on";const t=t=>{const s=t.clientX/window.innerWidth-.5,a=t.clientY/window.innerHeight-.5;e.querySelectorAll(".feature-float").forEach((e,t)=>{const n=(t+1)/l.length;e.style.transform=`translate3d(${16*s*n}px, ${16*a*n}px,0)`})};return window.addEventListener("pointermove",t),()=>window.removeEventListener("pointermove",t)},[]),t.jsxs("div",{ref:x,className:"auth-hero flex items-center justify-center px-4",children:[l.map((e,s)=>t.jsx("div",{className:"feature-float",style:{top:12+12*s+"%",left:s%2?"66%":"14%"},children:e},s)),t.jsxs("div",{className:"relative z-10 w-full max-w-md py-24",children:[t.jsx("h1",{className:"text-center text-3xl font-semibold mb-8 tracking-tight bg-clip-text text-transparent bg-gradient-to-b from-white to-white/60",children:"LiftLog"}),t.jsx(i,{onSignedIn:()=>{var t;const s=(null==(t=c.state)?void 0:t.redirectTo)||"/";e(s)},onForgot:()=>u(!0)}),t.jsx("p",{className:"mt-6 text-center text-[11px] text-gray-500",children:"By continuing you agree to the implicit terms of using a hobby project. Keep local backups."})]}),t.jsx(o,{open:d,onClose:()=>u(!1)})]})}export{c as default};
