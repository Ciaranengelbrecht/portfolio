let e=null,t=!1,a=1;function n(){if(e)return e;const t=window.AudioContext||window.webkitAudioContext;return e=t?new t:null,e}async function r(){const e=n();if(!e)return!1;if("suspended"===e.state)try{await e.resume()}catch{}return t="running"===e.state,t}function s(e){Number.isFinite(e)&&(a=Math.max(0,Math.min(4,e)))}function i(e,t={}){var r;const s=n();if(!s)return;const i=s.createOscillator(),o=s.createGain(),u=t.freq??1e3,l=Math.max(0,Math.min(1,t.volume??.08)),c=Math.min(.9,l*a),p=Math.max(.04,(t.durationMs??160)/1e3);i.type=t.type??"sine",i.frequency.setValueAtTime(u,e),null!=(null==(r=t.sweep)?void 0:r.to)&&i.frequency.linearRampToValueAtTime(t.sweep.to,e+p);let f=i;if(t.filter){const a=s.createBiquadFilter();a.type=t.filter.type,t.filter.frequency&&a.frequency.setValueAtTime(t.filter.frequency,e),t.filter.Q&&a.Q.setValueAtTime(t.filter.Q,e),null!=t.filter.gain&&a.gain.setValueAtTime(t.filter.gain,e),f.connect(a),f=a}if(t.shaper){const e=function(e,t=20,a="soft"){const n=44100,r=new Float32Array(n),s=Math.PI/180;for(let o=0;o<n;++o){const e=2*o/n-1;r[o]="hard"===a?Math.tanh(e*t):(3+t)*e*20*s/(Math.PI+t*Math.abs(e))}const i=e.createWaveShaper();return i.curve=r,i.oversample="4x",i}(s,"hard"===t.shaper?28:12,t.shaper);f.connect(e),f=e}o.gain.setValueAtTime(0,e);const h=.005,m=Math.max(.02,p-h-.03);o.gain.linearRampToValueAtTime(c,e+h),o.gain.linearRampToValueAtTime(.85*c,e+h+.6*m),o.gain.linearRampToValueAtTime(0,e+p),f.connect(o).connect(s.destination),i.start(e),i.stop(e+p+.02)}function o(e="gentle",t=2){const a=n();if(!a)return;"suspended"===a.state&&a.resume().catch(()=>{});const r=a.currentTime+.01,s=Math.max(1,Math.min(5,Math.floor(t||1))),o=t=>{switch(e){case"gentle":return{segs:[{at:t,opts:{freq:880,durationMs:150,volume:.095,type:"sine"}},{at:t+.2,opts:{freq:1175,durationMs:170,volume:.1,type:"sine"}}],length:.37};case"chime":return{segs:[{at:t,opts:{freq:1500,durationMs:190,volume:.1,type:"triangle",filter:{type:"bandpass",frequency:1500,Q:1.2}}},{at:t+.24,opts:{freq:1800,durationMs:210,volume:.1,type:"triangle",filter:{type:"bandpass",frequency:1800,Q:1.2}}}],length:.24+.21};case"digital":return{segs:[{at:t,opts:{freq:1100,durationMs:140,volume:.12,type:"square",filter:{type:"highpass",frequency:650,Q:.8},shaper:"hard"}},{at:t+.18,opts:{freq:1350,durationMs:150,volume:.12,type:"square",filter:{type:"highpass",frequency:700,Q:.8},shaper:"hard"}}],length:.18+.15};case"alarm":return{segs:[{at:t,opts:{freq:1900,sweep:{to:2600},durationMs:220,volume:.14,type:"sawtooth",filter:{type:"highpass",frequency:950,Q:.9},shaper:"hard"}},{at:t+.26,opts:{freq:2400,sweep:{to:2e3},durationMs:220,volume:.14,type:"sawtooth",filter:{type:"highpass",frequency:950,Q:.9},shaper:"hard"}}],length:.48};case"click":return{segs:[{at:t,opts:{freq:3200,durationMs:70,volume:.1,type:"square",filter:{type:"highpass",frequency:1200,Q:.7}}}],length:.07}}return o(t)};let u=r;for(let n=0;n<s;n++){const{segs:e,length:t}=o(u);for(const a of e)i(a.at,a.opts);u+=t+.14}}export{o as playBeepStyle,s as setBeepVolumeScalar,r as unlockAudio};
